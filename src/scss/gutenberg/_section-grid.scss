$block-padding: 14px;
$grid-desktop: repeat(12, 1fr); // Same as 12 instances of 1fr.
$grid-tablet: repeat(8, 1fr);
$grid-mobile: repeat(4, 1fr);

$grid-gutter: 1px;

// Standard Gutenberg Breakpoints
$break-huge: 1440px;
$break-wide: 1280px;
$break-xlarge: 1080px;
$break-large: 960px;	// admin sidebar auto folds
$break-medium: 782px;	// adminbar goes big
$break-small: 600px;
$break-mobile: 480px;
$break-zoomed-in: 280px;

/**
 * Visual grid overlay
 */
.wca-section {
	position: relative;

	&.alignfull {
		max-width: initial!important;
		padding: 0 12px;
	}

	&--tablet {
		.wca-section {
			&__overlay {
				grid-template-columns: $grid-tablet;
			}
		}
	}

	&--mobile {
		.wca-section {
			&__overlay {
				grid-template-columns: $grid-mobile;
			}
		}
	}

	&.is-selected,
	&.has-child-selected {
		.wca-section {
			&__overlay {
				position: absolute;

				&-col {
					box-shadow: -($grid-gutter / 2) 0 0 0 currentColor, ($grid-gutter / 2) 0 0 0 currentColor;
				}
			}
		}
	}

	&__overlay {
		// The following rules are for Safari.
		// A CSS grid rendering issue means the child nodes of this grid
		// won't stretch to fit the vertical space, unless the position
		// property is changed from absolute, to something else, and back.
		// By being relative when unselected and absolute when selected, we
		// constantly "refresh" this hack.
		position: relative;
		pointer-events: none;
		top: 0;
		left: 0; // -$grid-gutter;
		right: 0; // -$grid-gutter;
		bottom: 0;
		display: grid;
		grid-gap: $grid-gutter;
		grid-template-columns: $grid-desktop;
		color: rgba(0,0,0,0.1);
		// Lower the z-index so it's under the block borders.
		z-index: 0;
	}

	.wp-block-wca-section {
		margin-top: 0;
		margin-bottom: 0;

		& > .block-editor-inner-blocks > .block-editor-block-list__layout {
			// Prevent long unbroken words from overflowing.
			word-break: break-word; // For back-compat.
			overflow-wrap: break-word; // New standard.
			// Reset inherited negative margins.
			// These margins are in the block editor to compensate for the 14px block padding on all blocks.
			// They don't play well with CSS Grid, so we reset them, and re-apply them later.
			margin-left: 0;
			margin-right: 0;
		
			// Every block, including nested blocks, are born with an intrinsic minimum margin.
			// This resets that for the containers, which aren't meant to have that intrinsically.
			> .wp-block > .block-editor-block-list__block-edit > [data-block] {
				margin-top: 0;
				margin-bottom: 0;
			}
		
			.wp-block {
				max-width: 100%;
			}
		}
	}

	.wp-block-wca-column {
		margin: 0;
	}

	.block-list-appender {
		max-width: 100%!important;
	}
}