import{store as e,getContext as t,getElement as r,getConfig as E,withScope as a}from"@wordpress/interactivity";let{fn:{isDisabled:l,executeAfterTransition:i,validateConfig:o},Events:d,Backdrop:s,FocusTrap:n,ScrollBar:c,Selector:N}=wecodeart,NAME="offcanvas",NAMESPACE=`wecodeart/${NAME}`,DATA_KEY=`wp.${NAME}`,EVENT_KEY=`.${DATA_KEY}`,ESCAPE_KEY="Escape",EVENT_SHOW=`show${EVENT_KEY}`,EVENT_SHOWN=`shown${EVENT_KEY}`,EVENT_HIDE=`hide${EVENT_KEY}`,EVENT_HIDE_PREVENTED=`hidePrevented${EVENT_KEY}`,EVENT_HIDDEN=`hidden${EVENT_KEY}`,{state:h,actions:p,callbacks:g}=e(NAMESPACE,{state:{get useKeyboard(){return t().keyboard||h.keyboard},get hasBackdrop(){return t().backdrop||h.backdrop},get allowScroll(){return t().scroll||h.scroll}},actions:{toggle(){let e=t();e.isOpen?p.hide():p.show()},show(){let e=t();if(e.isOpen)return;let E=d.trigger(e.relatedElement,EVENT_SHOW,{relatedTarget:r().ref});if(E.defaultPrevented)return;let{classes:a}=h;e._backdrop.show(),h.allowScroll||new c().hide(),e.relatedElement.setAttribute("aria-modal",!0),e.relatedElement.setAttribute("role","dialog"),e.relatedElement.classList.add(a?.showing),g.onShow(e.relatedElement),e.isOpen=!0},hide(e){let r=t();if(!1===r.isOpen)return;let E=d.trigger(r.relatedElement,EVENT_HIDE,{relatedTarget:e});if(E.defaultPrevented)return;let{classes:a}=h;r._focustrap.deactivate(),r.relatedElement.blur(),r.relatedElement.classList.add(a?.hiding),r._backdrop.hide(),g.onHide(r.relatedElement),r.isOpen=!1}},callbacks:{onShow(e){let r=t(),{classes:E}=h;i(a(()=>{(!h.allowScroll||h.hasBackdrop)&&r._focustrap.activate(),e.classList.add(E?.show),e.classList.remove(E?.showing),d.trigger(e,EVENT_SHOWN)}),e,!0)},onHide(e){let{classes:t}=h;i(a(()=>{e.classList.remove(t?.show,t?.hiding),e.removeAttribute("aria-modal"),e.removeAttribute("role"),h.allowScroll||new c().reset(),d.trigger(e,EVENT_HIDDEN)}),e,!0)},onInit(){let{ref:e}=r(),E=t(),i=N.findOne(`#${e.getAttribute("aria-controls")}`);E.relatedElement=i;let o=()=>{if("static"===h.hasBackdrop){d.trigger(i,EVENT_HIDE_PREVENTED);return}p.hide("backdrop")};E._backdrop=new s({isVisible:Boolean(h.hasBackdrop),isAnimated:!0,rootElement:i.parentNode,clickCallback:Boolean(h.hasBackdrop)?a(o):null}),E._focustrap=new n({trapElement:i}),d.on(i,`click.dismiss${EVENT_KEY}`,`[data-wp-close="${NAME}"]`,a(({target:e})=>{!l(e)&&p.hide(e)})),d.on(document,`keydown.dismiss${EVENT_KEY}`,a(({key:t})=>{if(t===ESCAPE_KEY){if(h.useKeyboard){p.hide(ESCAPE_KEY);return}d.trigger(e,EVENT_HIDE_PREVENTED)}})),E.isOpen&&(E.isOpen=!1,p.show())},validateConfig:()=>o(NAME,{...h,...t()},E(NAMESPACE))}});