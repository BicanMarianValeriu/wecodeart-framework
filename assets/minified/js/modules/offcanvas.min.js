import{store as e,getContext as t,getElement as s,getConfig as a,withScope as o}from"@wordpress/interactivity";const{fn:{isDisabled:r,executeAfterTransition:i,validateConfig:n},Events:c,Backdrop:l,FocusTrap:d,ScrollBar:g,Selector:f}=wecodeart,p="offcanvas",h=`wecodeart/${p}`,w=`.${`wp.${p}`}`,u="Escape",b=`show${w}`,k=`shown${w}`,v=`hide${w}`,m=`hidePrevented${w}`,O=`hidden${w}`,{state:$,actions:S,callbacks:y}=e(h,{state:{get useKeyboard(){const{keyboard:e=$.keyboard}=t();return e},get hasBackdrop(){const{backdrop:e=$.backdrop}=t();return e},get allowScroll(){const{scroll:e=$.scroll}=t();return e}},actions:{toggle(){t().isOpen?S.hide():S.show()},show(){const e=t();if(e.isOpen)return;const a=y.getOffcanvas();if(c.trigger(a,b,{relatedTarget:s().ref}).defaultPrevented)return;const{classes:o}=$;e._backdrop.show(),$.allowScroll||(new g).hide(),a.setAttribute("aria-modal",!0),a.setAttribute("role","dialog"),a.classList.add(o?.showing),y.onShow(a),e.isOpen=!0},hide(e){const s=t();if(!1===s.isOpen)return;const a=y.getOffcanvas();if(c.trigger(a,v,{relatedTarget:e}).defaultPrevented)return;const{classes:o}=$;a.blur(),a.classList.add(o?.hiding),s._focustrap.deactivate(),s._backdrop.hide(),y.onHide(a),s.isOpen=!1}},callbacks:{onShow:e=>{const{classes:s,allowScroll:a,hasBackdrop:r}=$;i(o((()=>{a&&!r||t()._focustrap.activate(),e.classList.add(s?.show),e.classList.remove(s?.showing),c.trigger(e,k)})),e,!0)},onHide:e=>{const{classes:t,allowScroll:s}=$;i(o((()=>{e.classList.remove(t?.show,t?.hiding),e.removeAttribute("aria-modal"),e.removeAttribute("role"),s||(new g).reset(),c.trigger(e,O)})),e,!0)},onInit:()=>{y.getOffcanvas();const e=t();e.isOpen&&(e.isOpen=!1,S.show())},getOffcanvas:()=>{const e=t();if(!e.relatedElement){const{ref:t}=s(),{hasBackdrop:a,useKeyboard:i}=$,n=f.findOne(`#${t.getAttribute("aria-controls")}`),g=()=>{"static"!==a?S.hide("backdrop"):c.trigger(n,m)};c.on(n,`click.dismiss${w}`,`[data-wp-close="${p}"]`,o((({target:e})=>{r(e)||S.hide(e)}))),c.on(document,`keydown.dismiss${w}`,o((({key:e})=>{e===u&&(i?S.hide(u):c.trigger(t,m))}))),e.relatedElement=n,e._focustrap=new d({trapElement:n}),e._backdrop=new l({isVisible:Boolean(a),isAnimated:!0,rootElement:n.parentNode,clickCallback:Boolean(a)?o(g):null})}return e.relatedElement},validateConfig:()=>n(p,{...$,...t()},a(h))}});