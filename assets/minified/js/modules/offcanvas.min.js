import{store as e,getContext as t,getElement as E,getConfig as r,withScope as i}from"@wordpress/interactivity";let{fn:{isDisabled:a,executeAfterTransition:s,validateConfig:l},Events:n,Backdrop:o,FocusTrap:d,ScrollBar:c,Selector:N}=wecodeart,NAME="offcanvas",NAMESPACE=`wecodeart/${NAME}`,DATA_KEY=`wp.${NAME}`,EVENT_KEY=`.${DATA_KEY}`,ESCAPE_KEY="Escape",EVENT_SHOW=`show${EVENT_KEY}`,EVENT_SHOWN=`shown${EVENT_KEY}`,EVENT_HIDE=`hide${EVENT_KEY}`,EVENT_HIDE_PREVENTED=`hidePrevented${EVENT_KEY}`,EVENT_HIDDEN=`hidden${EVENT_KEY}`,{state:g,actions:f,callbacks:T}=e(NAMESPACE,{state:{get useKeyboard(){let{keyboard:h=g.keyboard}=t();return h},get hasBackdrop(){let{backdrop:A=g.backdrop}=t();return A},get allowScroll(){let{scroll:p=g.scroll}=t();return p}},actions:{toggle(){let e=t();e.isOpen?f.hide():f.show()},show(){let e=t();if(e.isOpen)return;let r=T.getOffcanvas(),i=n.trigger(r,EVENT_SHOW,{relatedTarget:E().ref});if(i.defaultPrevented)return;let{classes:a}=g;e._backdrop.show(),g.allowScroll||new c().hide(),r.setAttribute("aria-modal",!0),r.setAttribute("role","dialog"),r.classList.add(a?.showing),T.onShow(r),e.isOpen=!0},hide(e){let E=t();if(!1===E.isOpen)return;let r=T.getOffcanvas(),i=n.trigger(r,EVENT_HIDE,{relatedTarget:e});if(i.defaultPrevented)return;let{classes:a}=g;r.blur(),r.classList.add(a?.hiding),E._focustrap.deactivate(),E._backdrop.hide(),T.onHide(r),E.isOpen=!1}},callbacks:{onShow(e){let{classes:E,allowScroll:r,hasBackdrop:a}=g;s(i(()=>{(!r||a)&&t()._focustrap.activate(),e.classList.add(E?.show),e.classList.remove(E?.showing),n.trigger(e,EVENT_SHOWN)}),e,!0)},onHide(e){let{classes:t,allowScroll:E}=g;s(i(()=>{e.classList.remove(t?.show,t?.hiding),e.removeAttribute("aria-modal"),e.removeAttribute("role"),E||new c().reset(),n.trigger(e,EVENT_HIDDEN)}),e,!0)},onInit(){T.getOffcanvas();let e=t();e.isOpen&&(e.isOpen=!1,f.show())},getOffcanvas(){let e=t();if(!e.relatedElement){let{ref:r}=E(),{hasBackdrop:s,useKeyboard:l}=g,c=N.findOne(`#${r.getAttribute("aria-controls")}`),T=()=>{if("static"===s){n.trigger(c,EVENT_HIDE_PREVENTED);return}f.hide("backdrop")};n.on(c,`click.dismiss${EVENT_KEY}`,`[data-wp-close="${NAME}"]`,i(({target:e})=>{!a(e)&&f.hide(e)})),n.on(document,`keydown.dismiss${EVENT_KEY}`,i(({key:e})=>{if(e===ESCAPE_KEY){if(l){f.hide(ESCAPE_KEY);return}n.trigger(r,EVENT_HIDE_PREVENTED)}})),e.relatedElement=c,e._focustrap=new d({trapElement:c}),e._backdrop=new o({isVisible:Boolean(s),isAnimated:!0,rootElement:c.parentNode,clickCallback:Boolean(s)?i(T):null})}return e.relatedElement},validateConfig:()=>l(NAME,{...g,...t()},r(NAMESPACE))}});